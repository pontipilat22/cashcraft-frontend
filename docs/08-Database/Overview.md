# ğŸ—„ ĞĞ±Ğ·Ğ¾Ñ€ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

[[README|â† ĞĞ°Ğ·Ğ°Ğ´ Ğº ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ñ]]

---

## ğŸ“– Ğ§Ñ‚Ğ¾ Ñ‚Ğ°ĞºĞ¾Ğµ WatermelonDB?

**WatermelonDB** - ÑÑ‚Ğ¾ **Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ°Ñ Ğ±Ğ°Ğ·Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…** Ğ´Ğ»Ñ React Native Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹. ĞŸĞ¾ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ° Ğ¿Ğ¾Ğ²ĞµÑ€Ñ… SQLite Ğ¸ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ° Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ±Ğ¾Ğ»ÑŒÑˆĞ¸Ğ¼Ğ¸ Ğ¾Ğ±ÑŠĞµĞ¼Ğ°Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….

**Ğ¤Ğ°Ğ¹Ğ»Ñ‹:**
- `src/database/index.ts` - Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ‘Ğ”
- `src/database/schema.ts` - ÑÑ…ĞµĞ¼Ğ° Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†
- `src/database/models/` - Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

---

## ğŸ¯ ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ WatermelonDB?

### âœ… ĞŸÑ€ĞµĞ¸Ğ¼ÑƒÑ‰ĞµÑÑ‚Ğ²Ğ°:

1. **Offline-first Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´**
   - ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ğ±ĞµĞ· Ğ¸Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚Ğ°
   - Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ…Ñ€Ğ°Ğ½ÑÑ‚ÑÑ Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾
   - Ğ¡Ğ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¿Ğ¾ÑĞ²Ğ»ĞµĞ½Ğ¸Ğ¸ ÑĞµÑ‚Ğ¸

2. **Ğ’Ñ‹ÑĞ¾ĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ**
   - Lazy loading (Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¿Ğ¾ Ñ‚Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ)
   - ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
   - ĞÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ½Ñ‹Ğµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸

3. **Ğ ĞµĞ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾ÑÑ‚ÑŒ**
   - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ UI Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   - ĞŸĞ¾Ğ´Ğ¿Ğ¸ÑĞºĞ° Ğ½Ğ° Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ (`observe()`)
   - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ React Hooks

4. **ĞœĞ°ÑÑˆÑ‚Ğ°Ğ±Ğ¸Ñ€ÑƒĞµĞ¼Ğ¾ÑÑ‚ÑŒ**
   - Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ Ñ‚Ñ‹ÑÑÑ‡Ğ°Ğ¼Ğ¸ Ğ·Ğ°Ğ¿Ğ¸ÑĞµĞ¹
   - ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° Ğ¸Ğ½Ğ´ĞµĞºÑĞ¾Ğ²
   - Ğ­Ñ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸

### âš ï¸ ĞÑĞ¾Ğ±ĞµĞ½Ğ½Ğ¾ÑÑ‚Ğ¸:

- ĞÑƒĞ¶Ğ½Ğ¾ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ÑÑ‚ÑŒ ÑÑ…ĞµĞ¼Ñƒ Ğ·Ğ°Ñ€Ğ°Ğ½ĞµĞµ
- ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹
- ĞĞµĞ»ÑŒĞ·Ñ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ğµ SQL Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ API)

---

## ğŸ—º Ğ¡Ñ…ĞµĞ¼Ğ° Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ’ĞµÑ€ÑĞ¸Ñ ÑÑ…ĞµĞ¼Ñ‹: **4**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ˜                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                â”‚
â”‚  â”‚  users   â”‚                                                â”‚
â”‚  â”‚  (User)  â”‚                                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”‚ userId (foreign key)
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Ğ¤Ğ˜ĞĞĞĞ¡ĞĞ’Ğ«Ğ• Ğ¡Ğ§Ğ•Ğ¢Ğ                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                             â”‚
â”‚  â”‚  accounts   â”‚  ĞšĞ°Ñ€Ñ‚Ñ‹, Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ, ÑĞ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ¸Ñ, Ğ´Ğ¾Ğ»Ğ³Ğ¸        â”‚
â”‚  â”‚  (Account)  â”‚  â€¢ name, balance, currency, type           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚
         â”‚ accountId          â”‚ accountId
         â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  transactions    â”‚    â”‚      debts       â”‚
â”‚  (Transaction)   â”‚    â”‚      (Debt)      â”‚
â”‚  â€¢ amount        â”‚    â”‚  â€¢ amount        â”‚
â”‚  â€¢ date          â”‚    â”‚  â€¢ dueDate       â”‚
â”‚  â€¢ type          â”‚    â”‚  â€¢ description   â”‚
â”‚  â€¢ categoryId    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ categoryId
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   categories     â”‚
â”‚   (Category)     â”‚
â”‚  â€¢ name, icon    â”‚
â”‚  â€¢ color, type   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Ğ¤Ğ˜ĞĞĞĞ¡ĞĞ’Ğ«Ğ• Ğ¦Ğ•Ğ›Ğ˜                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚    goals     â”‚        â”‚  goal_transfers    â”‚              â”‚
â”‚  â”‚    (Goal)    â”‚â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  (GoalTransfer)    â”‚              â”‚
â”‚  â”‚ â€¢ targetAmountâ”‚        â”‚  â€¢ amount          â”‚              â”‚
â”‚  â”‚ â€¢ currentAmount        â”‚  â€¢ date            â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ĞšĞ£Ğ Ğ¡Ğ« Ğ’ĞĞ›Ğ®Ğ¢                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”‚
â”‚  â”‚ exchange_rates   â”‚                                         â”‚
â”‚  â”‚ (ExchangeRate)   â”‚                                         â”‚
â”‚  â”‚ â€¢ from_currency  â”‚                                         â”‚
â”‚  â”‚ â€¢ to_currency    â”‚                                         â”‚
â”‚  â”‚ â€¢ rate           â”‚                                         â”‚
â”‚  â”‚ â€¢ updated_at     â”‚                                         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ĞĞĞ¡Ğ¢Ğ ĞĞ™ĞšĞ˜ Ğ˜ Ğ¡Ğ˜ĞĞ¥Ğ ĞĞĞ˜Ğ—ĞĞ¦Ğ˜Ğ¯                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   settings     â”‚      â”‚  sync_metadata   â”‚                â”‚
â”‚  â”‚   (Setting)    â”‚      â”‚  (SyncMetadata)  â”‚                â”‚
â”‚  â”‚  â€¢ key, value  â”‚      â”‚  â€¢ lastSyncAt    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº Ğ²ÑĞµÑ… Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ† Ğ¸ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹

| # | Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ° | ĞœĞ¾Ğ´ĞµĞ»ÑŒ | ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ | Ğ¡Ğ²ÑĞ·Ğ¸ |
|---|---------|--------|----------|-------|
| 1 | `users` | User | ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ | â†’ accounts |
| 2 | `accounts` | Account | Ğ¡Ñ‡ĞµÑ‚Ğ° (ĞºĞ°Ñ€Ñ‚Ñ‹, Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ğµ, ÑĞ±ĞµÑ€ĞµĞ¶ĞµĞ½Ğ¸Ñ) | â† user, â†’ transactions, â†’ debts |
| 3 | `transactions` | Transaction | Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸ (Ğ´Ğ¾Ñ…Ğ¾Ğ´Ñ‹, Ñ€Ğ°ÑÑ…Ğ¾Ğ´Ñ‹, Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ñ‹) | â† account, â† category |
| 4 | `categories` | Category | ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹ | â†’ transactions |
| 5 | `debts` | Debt | Ğ”Ğ¾Ğ»Ğ³Ğ¸ Ğ¸ ĞºÑ€ĞµĞ´Ğ¸Ñ‚Ñ‹ | â† account |
| 6 | `goals` | Goal | Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ñ‹Ğµ Ñ†ĞµĞ»Ğ¸ | â†’ goal_transfers |
| 7 | `goal_transfers` | GoalTransfer | ĞŸĞµÑ€ĞµĞ²Ğ¾Ğ´Ñ‹ Ğ½Ğ° Ñ†ĞµĞ»Ğ¸ | â† goal |
| 8 | `exchange_rates` | ExchangeRate | ĞšÑƒÑ€ÑÑ‹ Ğ²Ğ°Ğ»ÑÑ‚ | - |
| 9 | `settings` | Setting | ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ | - |
| 10 | `sync_metadata` | SyncMetadata | ĞœĞµÑ‚Ğ°Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸ | - |

---

## ğŸ” Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹

### 1ï¸âƒ£ User (ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ)

```typescript
// src/database/models/User.ts
@tableSchema({
  name: 'users',
  columns: [
    { name: 'email', type: 'string' },
    { name: 'name', type: 'string', isOptional: true },
    { name: 'google_id', type: 'string', isOptional: true },
    { name: 'is_guest', type: 'boolean' },
    { name: 'created_at', type: 'number' },
    { name: 'updated_at', type: 'number' },
  ]
})
```

**ĞŸĞ¾Ğ»Ñ:**
- `email` - Email Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- `name` - Ğ˜Ğ¼Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ
- `google_id` - ID Google Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ° (Ğ´Ğ»Ñ OAuth)
- `is_guest` - Ğ“Ğ¾ÑÑ‚ĞµĞ²Ğ¾Ğ¹ Ñ€ĞµĞ¶Ğ¸Ğ¼?
- `created_at` - Ğ”Ğ°Ñ‚Ğ° ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ
- `updated_at` - Ğ”Ğ°Ñ‚Ğ° Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ

**Ğ¡Ğ²ÑĞ·Ğ¸:**
- `accounts` - Has many (Ñƒ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ÑÑ‡ĞµÑ‚Ğ¾Ğ²)

---

### 2ï¸âƒ£ Account (Ğ¡Ñ‡ĞµÑ‚)

```typescript
@tableSchema({
  name: 'accounts',
  columns: [
    { name: 'user_id', type: 'string', isIndexed: true },
    { name: 'name', type: 'string' },
    { name: 'balance', type: 'number' },
    { name: 'currency', type: 'string' },
    { name: 'type', type: 'string' }, // 'card', 'cash', 'savings', 'debt', 'credit'
    { name: 'icon', type: 'string', isOptional: true },
    { name: 'color', type: 'string', isOptional: true },
    { name: 'created_at', type: 'number' },
    { name: 'updated_at', type: 'number' },
  ]
})
```

**ĞŸĞ¾Ğ»Ñ:**
- `user_id` - ID Ğ²Ğ»Ğ°Ğ´ĞµĞ»ÑŒÑ†Ğ° ÑÑ‡ĞµÑ‚Ğ°
- `name` - ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ‡ĞµÑ‚Ğ° ("ĞœĞ¾Ñ ĞºĞ°Ñ€Ñ‚Ğ°")
- `balance` - Ğ¢ĞµĞºÑƒÑ‰Ğ¸Ğ¹ Ğ±Ğ°Ğ»Ğ°Ğ½Ñ
- `currency` - Ğ’Ğ°Ğ»ÑÑ‚Ğ° ÑÑ‡ĞµÑ‚Ğ° (USD, EUR, RUB...)
- `type` - Ğ¢Ğ¸Ğ¿ ÑÑ‡ĞµÑ‚Ğ° (card/cash/savings/debt/credit)
- `icon` - Ğ˜ĞºĞ¾Ğ½ĞºĞ° (Ionicons name)
- `color` - Ğ¦Ğ²ĞµÑ‚ Ğ² UI

**Ğ¡Ğ²ÑĞ·Ğ¸:**
- `user` - Belongs to (Ğ¿Ñ€Ğ¸Ğ½Ğ°Ğ´Ğ»ĞµĞ¶Ğ¸Ñ‚ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ)
- `transactions` - Has many (Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹)
- `debts` - Has many (Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ğ´Ğ¾Ğ»Ğ³Ğ¾Ğ²)

---

### 3ï¸âƒ£ Transaction (Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ñ)

```typescript
@tableSchema({
  name: 'transactions',
  columns: [
    { name: 'account_id', type: 'string', isIndexed: true },
    { name: 'category_id', type: 'string', isIndexed: true, isOptional: true },
    { name: 'amount', type: 'number' },
    { name: 'type', type: 'string' }, // 'income', 'expense', 'transfer'
    { name: 'date', type: 'number' },
    { name: 'description', type: 'string', isOptional: true },
    { name: 'to_account_id', type: 'string', isOptional: true }, // Ğ”Ğ»Ñ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¾Ğ²
    { name: 'created_at', type: 'number' },
    { name: 'updated_at', type: 'number' },
  ]
})
```

**ĞŸĞ¾Ğ»Ñ:**
- `account_id` - ID ÑÑ‡ĞµÑ‚Ğ°
- `category_id` - ID ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸
- `amount` - Ğ¡ÑƒĞ¼Ğ¼Ğ° Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
- `type` - Ğ¢Ğ¸Ğ¿ (income/expense/transfer)
- `date` - Ğ”Ğ°Ñ‚Ğ° Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
- `description` - ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ
- `to_account_id` - ID ÑÑ‡ĞµÑ‚Ğ° Ğ½Ğ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ (Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞ²Ğ¾Ğ´Ğ¾Ğ²)

**Ğ¡Ğ²ÑĞ·Ğ¸:**
- `account` - Belongs to (Ğ¿Ñ€Ğ¸Ğ½Ğ°Ğ´Ğ»ĞµĞ¶Ğ¸Ñ‚ ÑÑ‡ĞµÑ‚Ñƒ)
- `category` - Belongs to (Ğ¿Ñ€Ğ¸Ğ½Ğ°Ğ´Ğ»ĞµĞ¶Ğ¸Ñ‚ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸)

---

### 4ï¸âƒ£ Category (ĞšĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ)

```typescript
@tableSchema({
  name: 'categories',
  columns: [
    { name: 'name', type: 'string' },
    { name: 'icon', type: 'string' },
    { name: 'color', type: 'string' },
    { name: 'type', type: 'string' }, // 'income' Ğ¸Ğ»Ğ¸ 'expense'
    { name: 'created_at', type: 'number' },
    { name: 'updated_at', type: 'number' },
  ]
})
```

**ĞŸĞ¾Ğ»Ñ:**
- `name` - ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸
- `icon` - Ğ˜ĞºĞ¾Ğ½ĞºĞ° (Ionicons name)
- `color` - Ğ¦Ğ²ĞµÑ‚ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸
- `type` - Ğ¢Ğ¸Ğ¿ (income/expense)

**Ğ¡Ğ²ÑĞ·Ğ¸:**
- `transactions` - Has many (Ğ¼Ğ½Ğ¾Ğ³Ğ¾ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹)

---

### 5ï¸âƒ£ ExchangeRate (ĞšÑƒÑ€Ñ Ğ²Ğ°Ğ»ÑÑ‚)

```typescript
@tableSchema({
  name: 'exchange_rates',
  columns: [
    { name: 'from_currency', type: 'string', isIndexed: true },
    { name: 'to_currency', type: 'string', isIndexed: true },
    { name: 'rate', type: 'number' },
    { name: 'updated_at', type: 'number' },
  ]
})
```

**ĞŸĞ¾Ğ»Ñ:**
- `from_currency` - Ğ˜ÑÑ…Ğ¾Ğ´Ğ½Ğ°Ñ Ğ²Ğ°Ğ»ÑÑ‚Ğ° (USD)
- `to_currency` - Ğ¦ĞµĞ»ĞµĞ²Ğ°Ñ Ğ²Ğ°Ğ»ÑÑ‚Ğ° (EUR)
- `rate` - ĞšÑƒÑ€Ñ (0.92)
- `updated_at` - Ğ’Ñ€ĞµĞ¼Ñ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ

---

## ğŸ”„ Ğ–Ğ¸Ğ·Ğ½ĞµĞ½Ğ½Ñ‹Ğ¹ Ñ†Ğ¸ĞºĞ» Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

### Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ¿Ğ¸ÑĞ¸:

```
1. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ·Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ñ„Ğ¾Ñ€Ğ¼Ñƒ
   â†“
2. Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¼ĞµÑ‚Ğ¾Ğ´ ÑĞµÑ€Ğ²Ğ¸ÑĞ° (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, createAccount())
   â†“
3. LocalDatabaseService Ğ¾Ğ±Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ Ğº WatermelonDB
   â†“
4. WatermelonDB ÑĞ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ğ·Ğ°Ğ¿Ğ¸ÑÑŒ Ğ² SQLite
   â†“
5. Observable ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ÑĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑ‡Ğ¸ĞºĞ¾Ğ²
   â†“
6. React ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑÑ‚ÑÑ
```

### Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:

```
1. ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ Ğ¼Ğ¾Ğ½Ñ‚Ğ¸Ñ€ÑƒĞµÑ‚ÑÑ
   â†“
2. useEffect() Ğ²Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   â†“
3. LocalDatabaseService.getAccounts()
   â†“
4. WatermelonDB Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ query Ğº SQLite
   â†“
5. Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¼Ğ°ÑÑĞ¸Ğ² Ğ¼Ğ¾Ğ´ĞµĞ»ĞµĞ¹
   â†“
6. Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ÑÑ Ğ² state Ğ¸Ğ»Ğ¸ Context
   â†“
7. Ğ ĞµĞ½Ğ´ĞµÑ€Ğ¸Ñ‚ÑÑ Ğ² UI
```

### ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…:

```
1. ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ñ€ĞµĞ´Ğ°ĞºÑ‚Ğ¸Ñ€ÑƒĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
   â†“
2. Ğ’Ñ‹Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¼ĞµÑ‚Ğ¾Ğ´ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ
   â†“
3. WatermelonDB.update() Ğ² Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
   â†“
4. SQLite Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ ÑÑ‚Ñ€Ğ¾ĞºÑƒ
   â†“
5. Observable Ñ‚Ñ€Ğ¸Ğ³Ğ³ĞµÑ€Ğ¸Ñ‚ Ñ€Ğµ-Ñ€ĞµĞ½Ğ´ĞµÑ€
```

---

## ğŸ“Š ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ²ÑĞµÑ… ÑÑ‡ĞµÑ‚Ğ¾Ğ²:

```typescript
// Ğ’ LocalDatabaseService
async getAccounts(): Promise<Account[]> {
  const accounts = await database.collections
    .get<Account>('accounts')
    .query()
    .fetch();

  return accounts;
}
```

### ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹ ÑÑ‡ĞµÑ‚Ğ°:

```typescript
async getAccountTransactions(accountId: string): Promise<Transaction[]> {
  const transactions = await database.collections
    .get<Transaction>('transactions')
    .query(
      Q.where('account_id', accountId),
      Q.sortBy('date', Q.desc)
    )
    .fetch();

  return transactions;
}
```

### Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ Ğ´Ğ°Ñ‚Ğµ:

```typescript
async getTransactionsByDateRange(
  startDate: Date,
  endDate: Date
): Promise<Transaction[]> {
  const transactions = await database.collections
    .get<Transaction>('transactions')
    .query(
      Q.where('date', Q.gte(startDate.getTime())),
      Q.where('date', Q.lte(endDate.getTime())),
      Q.sortBy('date', Q.desc)
    )
    .fetch();

  return transactions;
}
```

### ĞŸĞ¾Ğ´ÑÑ‡ĞµÑ‚ ÑÑƒĞ¼Ğ¼Ñ‹:

```typescript
// Ğ”Ğ¾Ñ…Ğ¾Ğ´Ñ‹ Ğ·Ğ° Ğ¼ĞµÑÑÑ†
const transactions = await database.collections
  .get<Transaction>('transactions')
  .query(
    Q.where('type', 'income'),
    Q.where('date', Q.gte(startOfMonth)),
    Q.where('date', Q.lte(endOfMonth))
  )
  .fetch();

const totalIncome = transactions.reduce((sum, t) => sum + t.amount, 0);
```

---

## ğŸ”§ Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ°Ğ·Ñ‹ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…

**Ğ¤Ğ°Ğ¹Ğ»:** `src/database/index.ts`

```typescript
import { Database } from '@nozbe/watermelondb';
import SQLiteAdapter from '@nozbe/watermelondb/adapters/sqlite';
import schema from './schema';
import { Account, Transaction, Category, Debt, Goal, ... } from './models';

const adapter = new SQLiteAdapter({
  schema,
  jsi: true, // JSI Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ¹ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
  onSetUpError: (error) => {
    console.error('Database setup error:', error);
  },
});

export const database = new Database({
  adapter,
  modelClasses: [
    Account,
    Transaction,
    Category,
    Debt,
    Goal,
    GoalTransfer,
    ExchangeRate,
    User,
    Setting,
    SyncMetadata,
  ],
});
```

---

## ğŸ”„ ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸

ĞŸÑ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ ÑÑ…ĞµĞ¼Ñ‹ Ğ‘Ğ” Ğ½ÑƒĞ¶Ğ½Ğ¾ ÑĞ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ.

**ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¼Ğ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸:**

```typescript
// src/database/schema.ts
export const schema = appSchema({
  version: 4, // Ğ£Ğ²ĞµĞ»Ğ¸Ñ‡Ğ¸Ğ»Ğ¸ Ğ²ĞµÑ€ÑĞ¸Ñ Ñ 3 Ğ´Ğ¾ 4
  tables: [
    // ... Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†Ñ‹
  ]
});

// ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸
export const migrations = schemaMigrations({
  migrations: [
    // ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Ğ²ĞµÑ€ÑĞ¸Ğ¸ 3 Ğ½Ğ° 4
    {
      toVersion: 4,
      steps: [
        addColumns({
          table: 'accounts',
          columns: [
            { name: 'color', type: 'string', isOptional: true },
          ],
        }),
      ],
    },
  ],
});
```

---

## âš¡ ĞĞ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

### 1. Ğ˜Ğ½Ğ´ĞµĞºÑÑ‹:

```typescript
columns: [
  { name: 'account_id', type: 'string', isIndexed: true }, // Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¸ÑĞº
]
```

### 2. Lazy loading:

```typescript
// âŒ ĞŸĞ»Ğ¾Ñ…Ğ¾ - Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ²ÑĞµ ÑÑ€Ğ°Ğ·Ñƒ
const accounts = await database.collections.get('accounts').query().fetch();

// âœ… Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾ - Ğ·Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ¿Ğ¾ Ğ¼ĞµÑ€Ğµ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
const accounts$ = database.collections.get('accounts').query().observe();
```

### 3. Batch Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸:

```typescript
await database.write(async () => {
  // Ğ’ÑĞµ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ² Ğ¾Ğ´Ğ½Ğ¾Ğ¹ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¸
  await account1.update(/* ... */);
  await account2.update(/* ... */);
  await transaction1.update(/* ... */);
});
```

---

## ğŸ“š ĞŸĞ¾Ğ´Ñ€Ğ¾Ğ±Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

- [[08-Database/WatermelonDB|WatermelonDB - Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸]]
- [[08-Database/Models|ĞœĞ¾Ğ´ĞµĞ»Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…]]
- [[08-Database/Migrations|ĞœĞ¸Ğ³Ñ€Ğ°Ñ†Ğ¸Ğ¸ ÑÑ…ĞµĞ¼Ñ‹]]
- [[08-Database/Queries|Ğ—Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ñ‹]]

---

[[08-Database/WatermelonDB|Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ°Ñ: WatermelonDB â†’]]

[[README|â† ĞĞ°Ğ·Ğ°Ğ´ Ğº ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ğ½Ğ¸Ñ]]
